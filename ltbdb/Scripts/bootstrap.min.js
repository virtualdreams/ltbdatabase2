function split(n){return n.split(/;\s*/)}function extractLast(n){return split(n).pop()}$.widget("custom.catcomplete",$.ui.autocomplete,{_renderMenu:function(n,t){var r=this,i="";$.each(t,function(t,u){u.category!=i&&(n.append('<li class="ui-autocomplete-category">'+u.category+"<\/li>"),i=u.category);r._renderItemData(n,u)})}});String.prototype.format=function(){for(var n=this,t=arguments.length;t--;)n=n.replace(new RegExp("\\{"+t+"\\}","gm"),arguments[t]);return n};String.prototype.formatEx=function(n){var t=this;for(var i in n)t=t.replace(new RegExp("\\{"+i+"\\}","gm"),n[i]);return t};$(function(){var t,i,n;$("#q").autocomplete({source:"/api/search/title",minLength:3,select:function(n,t){t.item&&$(n.target).val(t.item.value);$(n.target.form).submit()},open:function(){$(this).autocomplete("widget").width($(this).outerWidth()-6)}});$("#t").autocomplete({source:function(n,t){$.getJSON("/api/search/tags",{term:extractLast(n.term)},t)},search:function(){var n=extractLast(this.value);if(n.length<3)return!1},focus:function(){return!1},select:function(n,t){var i=split(this.value);return i.pop(),i.push(t.item.value),i.push(""),this.value=i.join("; "),!1},open:function(){$(this).autocomplete("widget").width($(this).outerWidth()-6)}});jbox_image=new jBox("Image");jbox_tag=new jBox("Modal",{position:{x:"left",y:"top"},offset:{y:25},attach:$("#addtag"),target:$("#addtag"),content:$("#tag-msg-box"),overlay:!1,zIndex:400,closeOnClick:"overlay"});t='<div class="tag button-gray">\t\t\t\t\t\t\t<span class="upper tag-remove" data-id="{1}" data-tagid="{2}" title="Dieses Tag entfernen."><i class="material-icons bigger">delete<\/i><\/span>\t\t\t\t\t\t\t<a href="/tag/{0}" title="">{0}<\/a>\t\t\t\t\t\t<\/div>';$("#add-button").click(function(){data={id:$("#t").attr("data-id"),tags:$("#t").val()};$.ajax({cache:!1,url:"/api/tag/add",type:"POST",data:data,dataType:"json",statusCode:{403:function(){location.href="/account/login?ReturnUrl="+encodeURIComponent(location.pathname)},404:function(){alert("Resource not found.")}},success:function(n){$.each(n,function(n,i){var r=t.format(i.Name,i.Book,i.Id);$(r).insertBefore("#tag-add")});$("#t").val("");jbox_tag.close()}})});$(document).on("click",".tag-remove",function(){var n=$(this).parent();data={id:$(this).attr("data-id"),tagid:$(this).attr("data-tagid")};$.ajax({cache:!1,url:"/api/tag/remove",type:"POST",data:data,dataType:"json",statusCode:{403:function(){location.href="/account/login?ReturnUrl="+encodeURIComponent(location.pathname)},404:function(){alert("Resource not found.")}},success:function(t){t.success?$(n).remove():alert("Dieses Tag konnte nicht entfernt werden.")}})});i=$("#story-container");n='<div class="story">\t\t\t\t\t\t\t\t<input class="input" type="text" name="stories" value="" placeholder="Inhalt" /> <span class="button-green story-ins" title="Eintrag darüber einfügen."><i class="material-icons material-icons-small">add<\/i><\/span> <span class="button-red story-rem" title="Eintrag entfernen."><i class="material-icons material-icons-small">remove<\/i><\/span>\t\t\t\t\t\t\t<\/div>';$(document).on("click","#story-add",function(){$(n).appendTo(i)});$(document).on("click",".story-ins",function(){var t=$(this).parent();$(n).insertBefore(t)});$(document).on("click",".story-rem",function(){var n=$(this).parent();n.remove()});$("#cancel-edit").click(function(){location.href="/"});$.validator.addMethod("regex",function(n,t,i){return this.optional(t)||n.match(i)},"Please check your input.");$.validator.addMethod("nowhitespace",function(n,t){return this.optional(t)||n.trim()!=""},"No white space.");$("#book-form").validate({errorClass:"field-validation-error",validClass:"field-validation-valid",errorElement:"span",rules:{number:{required:!0,nowhitespace:!0,regex:"[0-9]+"},name:{required:!0,nowhitespace:!0}},messages:{number:{required:"Bitte gib eine Nummer ein.",nowhitespace:"Bitte gib eine Nummer ein.",regex:"Bitte gib eine Nummer ein."},name:{required:"Bitte gib einen Titel ein.",nowhitespace:"Bitte gib einen Titel ein."}}});$("#category-form").validate({errorClass:"field-validation-error",validClass:"field-validation-valid",errorElement:"span",rules:{name:{required:!0,nowhitespace:!0}},messages:{name:{required:"Bitte gib einen Namen ein.",nowhitespace:"Bitte gib einen Namen ein."}}});$("#tag-edit").validate({errorClass:"field-validation-error",validClass:"field-validation-valid",errorElement:"span",rules:{name:{required:!0,nowhitespace:!0}},messages:{name:{required:"Bitte gib einen Namen ein.",nowhitespace:"Bitte gib einen Namen ein."}}});$("#login-form").validate({errorClass:"field-validation-error",validClass:"field-validation-valid",errorElement:"span",rules:{username:{required:!0,nowhitespace:!0},password:{required:!0,nowhitespace:!0}},messages:{username:{required:"Bitte gib einen Benutzernamen ein.",nowhitespace:"Bitte gib einen Benutzernamen ein."},password:{required:"Bitte gib ein Passwort ein.",nowhitespace:"Bitte gib ein Passwort ein."}}})});
/*
//# sourceMappingURL=bootstrap.min.js.map
*/